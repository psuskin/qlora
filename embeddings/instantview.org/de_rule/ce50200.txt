Dies ist die Beschreibung der Funktionalität der Klasse "CX_EXCEL_XML" bezüglich Beschreibung: Objekte dieser Klasse repräsentieren Excel-Dokumente. Die Objekte bieten die Möglichkeit .xlsx-Dateien einzulesen, zu bearbeiten und wieder als .xlsx-Datei abzuspeichern. Die Objekte bieten genau, wie CX_WORD_XML die Möglichkeit an, die XML-Daten als .xml Datei im Klartext abzulegen, diese können von Excel jedoch nicht geöffnet werden. Die Verarbeitung von Excel-Dokumenten ist momentan gewissen Einschränkungen unterworfen, welche in den entsprechenden Funktionen(GetValue & SetValue) näher erläutert werden. Die Parameter sind generell nach der Änderungsrate angeordnet. Parameter, die sich häufig ändern(Wert, Spalte) stehen bei Aufrufen weiter links, als die Parameter, die seltener geändert werden. (Zeile, Arbeitsblatt) Hierbei wird davon ausgegangen, dass Excel-Dokumente zeilenweise in aufsteigender Reihenfolge- und innerhalb der Zeile spaltenweise verarbeitet werden. Die CX_EXCEL_XML-Klasse verfügt über einen Caching-Mechanismus, welcher nur dann voll zur Geltung kommt, wenn die Zeilen in möglichst kleinen Intervallen in aufsteigender Reihenfolge bearbeitet werden. Da für das Bearbeiten von XML die gesamte XML-Struktur im Speicher nachgebaut werden muss, gibt es dafür eine technisch bedingte(32-Bit System) Größenbeschränkung. Diese liegt bei einer ca. 20 MB großen .xlsx-Datei. Da für einen Großteil der Anwendungen das Lesen aus großen Excel-Dateien wichtig ist, wurde ein "readonly mode" für diese XML-Klasse implementiert. CX_EXCEL_XML öffnet automatisch jede .xlsx-Datei vorerst im "readonly mode", wenn sie mit LoadFromFile geladen wurde. In diesem Modus werden die relevanten Dateiteile als temporäre Dateien ins TEMP-Verzeichnis entpackt und von dort im sogenannten Streaming-Mode eingelesen. Die temporären Dateien werden gelöscht, sobald das XML-Objekt gelöscht wird oder das Objekt in den "write mode" wechselt. In diesem Modus kann CX_EXCEL_XML beliebig große Dateien öffnen. In den "write mode" (auch DOM-Mode) kann das CX_EXCEL_XML-Objekt auf zwei verschiedene Weisen wechseln. Entweder durch den Aufruf einer Methode, die das XML verändern würde (EmptyDocument, SetColorIndex, SetValue) oder durch das explizite Versetzen in den "write mode" mittels SetWriteMode. Beim Öffnen eines Dokuments im "readonly mode" wird der Dateipfad der Originaldatei im Objekt abgelegt. Dieser Dateipfad wird später verwendet, um in den "write mode" zu wechseln. Sollte sich also diese Datei während der Verarbeitung verändern, dann sollte vor der Verarbeitung mit SetWriteMode der Wechsel in den "write mode" erzwungen werden. In der Performance unterscheiden sich "readonly mode" und "write mode" kaum. Der einzige Unterschied ist die Größenbeschränkung der Dateien beim "write mode". Dies ist die Beschreibung der Funktionalität der Klasse "CX_EXCEL_XML" bezüglich Code-Beispiel: Das folgende Script erhöht den Inhalt jeder numerischen Zelle eines Excel-Dokuments. Alle anderen Zellen werden rot eingefärbt. * MA = Member-Access-Funktion * I = Indizierbares Datenfeld.