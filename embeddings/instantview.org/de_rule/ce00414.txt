Dies ist die Beschreibung der Funktionalität der Klasse "CX_FORMULA - Formeln" bezüglich Beschreibung: Berechnungsvorschriften, die nicht als Bestandteil eines Programms sondern als vom Anwender erzeugte und verwaltete Daten existieren, werden im ClassiX®-System durch Objekte der Klasse CX_FORMULA repräsentiert. Ein Formel-Objekt enthält einen arithmetischen Ausdruck in der externen, vom Menschen lesbaren Form und gleichzeitig eine interne Darstellung, die eine sehr schnelle Auswertung der Ausdrücke erlaubt. Das Ergebnis der Auswertung einer Formel kann ein beliebiges Objekt sein (ein numerischen Wert, ein Wahrheitswert, Datum, Zeichenkette usw.). Die Elemente einer Formel sind Operanden, Operatoren, InstantView® Makros und Funktionsaufrufe. Operanden sind Variablen oder Konstanten. Hinweis: Die Operanden sind immer Objekte. Die in einer Formel erlaubten Operationen rufen entsprechende virtuelle Funktionen der Operanden auf, und damit bestimmt das Objekt die Semantik der Operatoren. Die Syntax der Formelausdrücke entspricht der Syntax für die Beschreibung arithmetischer Ausdrücke in BASIC, FORTRAN und anderen üblichen (prozeduralen) Programmiersprachen. Terme können in Klammern zusammengefasst werden, um die Reihenfolge der Operationen zu beeinflussen. Die vollständige Grammatik ist hier in EBNF-Notation dokumentiert. Mehrere Funktionsparameter werden durch Komma getrennt. Einzelne Ausdrücke, die unabhängig voneinander ausgewertet werden sollen, sind durch Semikolon zu trennen (das ist sinnvoll bei Zuweisungen mit :=). Im Formelausdruck dürfen Kommentare in der in C++ üblichen Form untergebracht werden, d.h. an beliebiger Stelle mit /* . */ und am Ende mit // Variablen und externe Funktionen beziehen sich auf bisher noch nicht näher bestimmte Objekte. Erst bei der Auswertung der Formel werden diesen Operanden Datenfelder bzw. Methoden bestimmter Objekte zugeordnet und damit ihr Wert festgelegt. Zu diesem Zweck werden im ClassiX®-System Objekte registriert (PlugSpace), und so entsteht ein aktueller Kontext, durch den die Variablen der Formel eine konkrete Bedeutung erhalten (Beispiel). Dies ist die Beschreibung der Funktionalität der Klasse "CX_FORMULA - Formeln" bezüglich Darstellung am Bildschirm: Zur Darstellung von Objekten dieser Klasse wird ein Oberflächenobjekt vom Typ String verwendet. Die folgende Abbildung zeigt ein Beispiel (Programmcode): * MA = Member-Access-Funktion. Dies ist die Beschreibung der Funktionalität der Klasse "CX_FORMULA - Formeln" bezüglich Spezielle Funktionen innerhalb eines Formelausdrucks: * I = Indizierbares Datenfeld.