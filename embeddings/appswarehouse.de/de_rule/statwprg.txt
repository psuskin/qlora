Dies ist die Beschreibung des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung": Dieses Modul ist Teil der Nachkalkulation. Die angefallenen Ist-Kosten der Kundenaufträge können entsprechend dem Fakturierungsstatus (nicht fakturiert/teilweise fakturiert/fakturiert) des jeweiligen Kundenauftrages und die Lageraufträge können entsprechend dem Bearbeitungszustands (eingelagert, bereitgestellt, Fertigungsauftrag usw.) angelistet werden. Die Einstellung für die Selektierung der Kunden- und Lageraufträge werden so initialisiert, dass die aktuellen "Unfertigen Erzeugnisse" aufgelistet werden.Die Kundenaufträge können auch gemeinsam mit den ihnen zugeordneten internen Werksaufträgen angelistet werden. Auch ist eine Vorselektion nach Auftragsarten möglich.Es werden alle Ist-Kosten bis zu der ausgewählten Abgrenzungsperiode aufgelistet, eine von - bis Perioden Aufstellung ist ebenfalls möglich. Aufträge ohne Kosten können ausgeblendet werden.WICHTIG! Vor dem Aufruf der Auftragskostenauswertung müssen die unterdrückten Fehler der einzelnen Datenbankoperationen geprüft und korrigiert worden sein. Nur so kann das richtige Ergebnis ermittelt werden. Fehlende Daten in Teilen kann dazuführen das diese nicht in der Auftragskostenauswertung berücksichtigt werden. Ob Beleg die dem Auftrag zugeordnet worden sind alle gebucht sind, kann mit mit Kontextmenü "Anzeige aller Nachfolger" überprüft werden.Handelt es sich um Auftragspositionen über ein Teil mit der Bereitstellungsart Kanban, keine Disposition, Handlager ohne Hauptlagerführung oder Kanban Halbzeug, dann wird der auf der Auftragsposition stehende Einstandswert in der IST-Kosten Spalte "Lager Kaufteile" angezeigt.Aufträge sind immer einem Kostenträger zugeordnet, d.h. die auf einen Auftrag gebuchten Kosten werden auch beim Kostenträger gebucht und können über die Kostenträger Summenliste oder die Kostenartenauswertung pro Kostenträger eingesehen werden. Es kann aber durchaus sein, dass Kosten nur auf Kostenträger - ohne Angabe eines Auftrages - gebucht werden, weshalb es Differenzen zwischen den Angaben der Kosten in dieser Auftragskostenauswertung und denen der o.g. anderen Kostenträgerlisten geben kann. Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Abgrezungsperiode: Mit der Abgrenzungsperiode wird definiert bis zu welchem Zeitpunkt oder aus welchem Zeitraum Kosten für die Berechnung der Auftragskosten in der Liste verwendet werden sollen. Über die Abgrenzungsperiode werden nicht die Aufträge direkt selektiert, d.h. Sie können damit Aufträge auswählen die in einem bestimmten Zeitraum angelegt wurden. Ist die Checkbox "von-bis-Periode" nicht gesetzt, werden alle Buchungen mit Kosten bis zur der Abrechnungsperiode berücksichtigt. Ist die Checkbox "von-bis-Periode" gesetzt, werden nur Buchungen mit Kosten berücksichtigt, die zwischen den beiden Abrechnungsperioden gebucht wurden. Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Prüfungsmöglichkeiten: Zur Prüfung der Auftragskostenauswertung stehen über das Kontextmenu (rechte Maustaste) der Liste verschiedene Möglichkeiten zur Verfügung (siehe). Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Anzeige nachkalkulierter Ist-Belege: Belege werden automatische für die Nachkalkulation erfasst, wenn diese gebucht werden. Es werden die aktuellen Kosten aus dem Standardwert des Bestellteils oder den Material- und Lohnkosten des Fertigungsteils ermittelt. Konnten Kosten ermittelt werden wird der Beleg mit der Liste "verbuchte Belege" angezeigt. Bei fehlenden Kosten oder anderer Fehler wegen unvollständigen bzw. falschen Daten wird der Beleg bei den unterdrückten Fehlern gelistet. Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Anzeige aller Nachfolge-Belege (aus Beleghistorie): Anzeige aller Beleg die mit dem Auftrag verbucht wurden und normalerweise Ist-Kosten für die Kalkulation enthalten. Sie können diese Liste "verbuchte Belege" selektiert nach Belegen mit und ohne Kosten ausgeben. Beleg ohne Kosten wurden nicht in die Nachkalkulation verbucht und müssen über das Modul "unterdrückte Fehler" kontrolliert und nachgebucht werden. Die nicht gebuchten Belege können in der Auswahl "Belege ohne Kosten anzeigen" über das Kontextmenü der Liste "Unterdrückten Fehler für Beleg anzeigen" korrigiert werden. Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Anzeige nachkalkulierter IST-Materialaufwand: Eine Liste aller Teile die für den Auftrag in die Kalkulation mit IST-Kosten gebucht wurden. Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Summe Kosten: Zeigt die Summe der Ist-Kosten für die selektierten Zeilen an. Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Neuberechnung der Ist-Kosten: Hier können Sie eine Neuberechnung der Ist-Kosten der Lagerbewegungen (d.h. Auslagerung und Einlagerungen), der aufgelösten Stücklisten (z.b. JIT-, KANBAN-Teile und Handlager) und der BDE Arbeitszeiten für die in der Listbox selektierten Aufträge durchführen. Es werden normalerweise nur die Beleg neu berechnet die bereits in der Nachkalkulation berücksichtigt werden. Sie können jedoch durch das Setzten der Checkbox "Nicht berücksichtigte Nachfolge-Belege prüfen" erreichen, das alle Nachfolge-Belege überprüft werden. Jeder Beleg wird aus der Nachkalkulation ausgebucht und wie gewählt mit dem gültigen Kosten an dem Belegdatum oder dem Gültigkeitsdatum, das in der Maske erfasst werden kann, wieder eingebucht. Die neuen Ist-Kosten werden sofort in die Belege und somit in die Nachkalkulation des Auftrags geschrieben. Sie haben durch das neu berechnen der Belege mit dem Belegdatum nur die Möglichkeit den alten Stand annährend zu erreichen. Deswegen sollte der Aufruf dieser Funktion mit bedacht, am besten noch zuerst in einer Testumgebung ausgeführt werden. Für die Nachverfolgung werden alle Änderungen an den Ist-Kosten der Nachkalkulation in die Datei "NeuBerechnungIstKosten_Datum.log" im temporären Verzeichnis geschrieben. Hinweis: Es ist zu beachten, dass bei der Neuberechnung das systemweite Gültigkeitsdatum geändert wird. Sollte der Lauf abbrechen wird das systemweite Gültigkeitsdatum NICHT wieder auf das aktuelle Datum zurückgestellt, dann ist darauf zu achten das systemweite Gültigkeitsdatum wieder auf das Tagesdatum zurück zu stellen. Dies geschieht über das Hauptmenü "System - Ändern Datum - Sitzungsdatum", dort das Feld "Gültigkeitsdatum". Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Belegkennzeichnung: Wenn in der Nachkalkulation ein Beleg gefunden wird, der das Flag realEnd.counter[[2] = 1 UND realEnd.counter[[3] = 1 hat, dann muss dieser Beleg erst ausgebucht werden! Erläuterung in Bezug auf Nachtläufe: Sobald ein Beleg Bit 1, 2 oder 5 hat, wird er nicht mehr für den Nachtlauf herangezogen. Falls solche Beleg aus- und eingebucht werden, wird die Kalkulation sofort gebucht. Im laufenden Betrieb muss jeder auszubuchende Beleg überprüft werden, ob er auch aus der Kalkulation ausgebucht werden muss. Dies erkennt das Modul am realEnd.counter[[3]=1. Wenn die Position jetzt ausgebucht, verändert und durch die normale Buchung wieder eingebucht wird, erkennt das Modul am realEnd.counter[[2], dass dieser Beleg wieder in die Nachkalkulation eingebucht werden muss. Der realEnd.counter[[2] wird nie wieder aus dem Beleg gelöscht, wenn er einmal gesetzt ist. Er ist das Kennzeichen, dass der Beleg bereits einmal in der Nachkalkulation verbucht war. Ist der realEnd.counter[[5] auf einem Beleg gesetzt, braucht er nicht vor dem normalen Buchen aus der Nachkalkulation ausgebucht und auch nicht wieder eingebucht werden!!! Diese Prüfung übernimmt aber dieses Modul, es braucht nicht in jedem anderen Modul überprüft werden! Dies ist die Beschreibung der Funktionalität des Moduls "statwprg" mit dem Namen "Auftragskostenauswertung" bezüglich Online Verbuchung der Belege - Grundsätze: Ist der Beleg bereits in die Nachkalkulation gebucht worden, so ist er vorher auszubuchen. Dies wird in der Regel über die Makros BookItem und UnbookItem des jeweiligen Moduls realisiert. Hier wird vor dem Ausbuchen des Belegs aus seiner normalen Verbuchung erst geprüft, ob das Bit 3 des realEnd.counters gesetzt ist, das heißt, ob der Beleg auch in der Nachkalkulation verbucht ist: transaction Copy(realEnd.counter[[3]) if { transaction (-1) SendMsg(LOAD_STOCK_WITHDRAWAL_ITEM) } Nach dem Einbuchen über die normale Verbuchung muss dann ebenfalls geprüft werden, ob der Beleg in die Nachkalkulation gebucht werden soll: Aufschluss darüber gibt das Bit 2 des realEnd.counter s. transaction Copy(realEnd.counter[[2]) if { transaction 1 SendMsg(LOAD_STOCK_WITHDRAWAL_ITEM) }.