Dies ist die Beschreibung des Moduls "cxItemCostEstimate" mit dem Namen "Teile Vorkalkulation": Erfassen Sachmerkmale (optional) Erfassen Kostensätze (optional) Teil(e) auswählen Kalkulieren Fehlerprotokoll Aufgelöste Ressourcen bearbeiten (optional) Übertragen der Kalkulationswerte in die Stammdaten Evtl. neues Kalkulieren mit geänderten Einstellungen Dieses Modul dient zur Vorkalkulation von Teilen aus dem Teilestamm. Die Hauptmaske - aus der heraus die Vorkalkulation vorgenommen wird - hat drei Fenster/Karten: die Karte mit der Liste der zu kalkulierenden Teile (Teile), eine Karte mit Sachmerkmalen (Sachmerkmale) und eine Karte mit Kostensätzen (Kostensätze). Der generelle Ablauf einer Teile Vorkalkulation ist der folgende: 0a. Erfassen Sachmerkmale (optional) Da eine Vorkalkulation auch über Variantenteile erfolgen kann, können vorab Sachmerkmalsausprägungen im Fenster Sachmerkmale hinterlegt werden: man verhindert hiermit die interaktive Abfrage von Sachmerkmalen, während der Auflösung der Stücklisten und Arbeitsplänen. Dieses ist eine Möglichkeit der Hinterlegung von Sachmerkmalsausprägungen. Eine weitere besteht darin, dass jede Vorkalkulation für sich eigene Sachmerkmalsausprägungen halten kann, was weiter unten beschrieben wird.Sachmerkmale können über den Knopf "Übernehmen" über der Sachmerkmalsliste aus den Stammdaten (Teil + Fertigungsrolle) übernommen werden.0b. Erfassen Kostensätze (optional) Die Kostensätze in Form der Gemeinkostenzuschläge für Material, Lohn, Vertrieb und Verwaltung werden standardmäßig aus entsprechenden Hinterlegungen beim Mandanten in das Fenster Kostensätze kopiert. Diese Werte können hier überschrieben werden. Auch hier gilt, dass jede Vorkalkulation für sich die Kostensätze speichert und diese dort überschrieben werden können. Dieses wird ebenfalls weiter unten näher erläutert. 1. Teil(e) auswählen Hierbei hat man die Wahl zwischen einer einfachen Auswahl nach Nummer/Text, usw. oder über weitere komplexere Suchkriterien, wie Lager, Logistikkennzeichen, o.„. Es können nur Teile für eine Vorkalkulation ausgewählt werden, die eine Fertigungsrolle haben: in der Fertigungsrolle werden die Stückliste und der Arbeitsplan eines Teils definiert. Für jedes neu ausgewählte Teil wird automatisch eine neue Vorkalkulation angelegt. Diese Vorkalkulation erhält eine eigene Nummer und wird bei der Fertigungsrolle des Teils hinterlegt. Auch werden in die Vorkalkulation eventuell vorhandene Sachmerkmale aus dem Fenster Sachmerkmale und die Kostensätze aus dem Fenster Kostensätze kopiert. Außerdem kann man aber noch von Hand Sachmerkmale einfügen, oder auch ändern, wenn zum Beispiel im Hauptfenster keine vorgegeben worden, oder nicht ausreichend sind. Genau wie auch im Hauptfenster gibt es hier zwei Möglichkeiten des Einfügens: Es wird in die Vorkalkulation auch eine Losgröße kopiert: Diese ist abhängig von der Option "Losgröße", nach der die Losgröße aus der Fertigungsrolle oder aus einer manuellen Vorgabe kopiert wird.Es ist außerdem möglich, Ergebnisse der Verkaufsartikelumsatzstatistik in die Teilevorkalkulationsliste zu ziehen. In der Verkaufsartikelumsatzstatistik hat man die Möglichkeit, z.B. alle Ersatzteile mit einem positiven Umsatz in der aktuellen Statistikperiode anzeigen zu lassen und die Vorkalkulation nur für diese Teile zu starten. 2. Kalkulieren Die in der Liste ausgewählten (oder alle) Teile können anschließend vorkalkuliert werden. Man kann hierbei wählen zwischen einer Kalkulation nach Standardwerten (es werden nur die Sachmerkmale und Kostensätze aus den Vorkalkulationsfenstern berücksichtigt) oder einer individuellen Kalkulation: es werden die Werte aus der gespeicherten Vorkalkulation genommen. Sollten weder die Werte in der Vorkalkulation noch die Werte in den Fenstern nach Auswahl eines Teils verändert worden sein, so sind beide Verfahren natürlich identisch. Bei der Kalkulation werden die Stückliste(n) und Arbeitspläne gemäß den Vorgaben unter Option/Stufigkeit aufgelöst. Der jeweilige Stand einer Auflösung wird in der Statuszeile des Vorkalkulationsfensters angezeigt. Am Ende einer Kalkulation werden die neuen Werte für Material und Lohn (per Losgröße) und damit die Herstellkosten (per 1 Einheit) angezeigt. 3. Fehlerprotokoll Mögliche Fehler bei Auflösung der Stücklisten und Arbeitspläne, sowie fehlende Bewertungen führen zu einer fehlerhaften Vorkalkulation. Ein Fehlerprotokoll kann daher optional auf dem Bildschirm ausgegeben oder in eine Datei geschrieben werden. Folgende Fehlerursachen werden überprüft: 1. Fehlende Menge einer Ressource 2. Ein aufzulösendes Fertigungsteil hat keine Stückliste/keinen Arbeitsplan 3. Eine Ressource hat keine Material-/Lohnkosten Sollte eine Vorkalkulation einen oder mehrere Fehler haben, so können diese Daten nicht in die Fertigungsrolle des Teils als neue Herstellkosten übertragen werden. 4. Aufgelöste Ressourcen bearbeiten (optional) Die entstandene Stückliste und der aufgelöste Arbeitsplan können eingesehen werden. Zum einen als Strukturbaum, zum anderen in einer tabellarischen Form mit genauer Anzeige der Kosten und Zuschlagssätze. 5. Übertragen der Kalkulationswerte in die Stammdaten Die neuen (fehlerfreien) Vorkalkulationswerte werden mit Datum in die Fertigungsrolle des Teils übertragen. 6. Evtl. neues Kalkulieren mit geänderten Einstellungen Damit man nicht wieder komplett eine Teilevorkalkulation ausfüllen muss, also zum Beispiel wieder Sachmerkmale einfügen und entsprechend ausprägen, evtl. sogar die Kostensätze oder aber auch Dokumente einfügen möchte, kann man eine schon bestehende Teilevorkalkulation aus dem Listenfenster heraus kopieren. Das geht entweder über das Hauptmenü des Listenfensters oder aber auch über das Kontext-Menü in der Liste. Es werden die Beschreibung, Losgröße, Sachmerkmale inklusive Ausprägungen, Kostensätze und Dokumente (keine bedingten) kopiert. Dies ist die Beschreibung der Funktionalität des Moduls "cxItemCostEstimate" mit dem Namen "Teile Vorkalkulation" bezüglich Listenfenster: Auf der Karte ‚Teile’ werden die sich in Bearbeitung befindlichen Vorkalkulationen angelistet. Auf der Karte ‚Merkmale’ der Teilekalkulation, können Sie die Sachmerkmale einfügen oder löschen, die zum Auflösen der Stücklisten und Arbeitspläne notwendig sind. Auf der Karte ‚Kostensätze’ werden die globalen Kostensätze aus dem Mandanten angezeigt und können dort lokal verändert werden. Dies ist die Beschreibung der Funktionalität des Moduls "cxItemCostEstimate" mit dem Namen "Teile Vorkalkulation" bezüglich Optionsfenster: Bei jedem Öffnen des Haupt-Listenfensters werden die hier beschriebenen Optionen auf die Standardeinstellungen zurückgesetzt. Dies ist die Beschreibung der Funktionalität des Moduls "cxItemCostEstimate" mit dem Namen "Teile Vorkalkulation" bezüglich Eingabefenster: In diesem Fenster können Daten einer Vorkalkulation bearbeitet und ergänzt werden. Dies ist die Beschreibung der Funktionalität des Moduls "cxItemCostEstimate" mit dem Namen "Teile Vorkalkulation" bezüglich Selektionsfenster: Dieses Fenster dient der Selektion einer Teile Vorkalkulation. Dies ist die Beschreibung der Funktionalität des Moduls "cxItemCostEstimate" mit dem Namen "Teile Vorkalkulation" bezüglich Übernahme in Fertigungsrolle: Die Vorkalkulation kann in die Teilerolle übernommen werden. Dies kann nur einmal gemacht werden. Dies ist die Beschreibung der Funktionalität des Moduls "cxItemCostEstimate" mit dem Namen "Teile Vorkalkulation" bezüglich Fehlerfenster: In diesem Fenster werden die Fehlermeldungen der selektierten Vorkalkulation angezeigt. Durch einen Doppelklick auf einen Eintrag öffnet sich das Vorkalkulationsblatt und die entsprechende Position wird markiert. So sind Fehler noch leichter zu identifizieren und zu beheben (durch manuelle Preisvergabe, etc.). Dies ist die Beschreibung der Funktionalität des Moduls "cxItemCostEstimate" mit dem Namen "Teile Vorkalkulation" bezüglich Ablauf Teile Vorkalkulation: Makro ComputeCostEstimate Die eigentlichen Berechnungen passieren im Makro NewPricePerPiece, welches wiederum das Makro Costs aufruft (s.o.): updateMode = TRUE à SumUpCosts Je nach Aufruf werden material.costs oder wages.costs pro Eintrag geschrieben wo ermittelt. Variable totalCosts enthält die Gesamtkosten je Art (Material/Lohn). Auf dem Stack bleibt der Gesamtwert – inkl. der Werte der Unterteile – stehen, umgerechnet per Losgröße. Wenn also irgendetwas verändert wurde, kann über "Kalkulation aktualisieren" mittels NewPricePerPiece mit updateMode == TRUE alles neu durchgerechnet werden. updateMode = FALSE à SumUpImputedCosts Die bereits in den einzelnen aufgelösten Positionen abgelegten Kosten werden aufaddiert. Übernahme In CX_PRODUCT wegschreiben von imputed.date in CX_ITEM_COST_ESTIMATE::transfered.date.