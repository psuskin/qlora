Dies ist die Beschreibung des Moduls "stockSwitching" mit dem Namen "Warenumlagerung": Sie können Waren von einen zu einen anderen Lagerplatz umlagern. Die Lagerplätze müssen nicht im selben Lager sein.Wenn ein Umlagerungsbeleg gebucht wird, so wird auf dem entsprechenden Lagerstatistik-Monat ein Datenfeld "switched.quantity" auf dem "Quell-Lager" unter folgenden Bedingungen geschrieben:Quell-Lager ist Lager des Hauptmandanten und Lager ist dispositiv (Häkchen "keine Disposition" ist NICHT gesetzt)UND( Teil ist Handlagerteil ODER Ziel-Lager ist nicht Lager des Hauptmandanten ODER Ziellager ist nicht dispositiv (Haken "keine Disposition" IST gesetzt)Diese Menge (switched.quantity) wird für die Sicherheitsbestandsberechnung benutzt (Ersatzteilgeschäft). Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Eingabefenster: Dieses Fenster dient der Pflege von Umlagerungen. Sie können eine Umlagerung auswählen, in dem Sie im Feld Nummer die gewünschte Nummer eingeben und mit RETURN bestätigen. Wenn Sie das Listenfenster aufrufen wollen, dann können Sie den Menüpunkt "Suchen" auswählen. Nachdem Sie einen Mitarbeiter ausgewählt und den ‚OK’-Button betätigt haben, vergibt das System automatisch eine laufende Belegnummer. Mit dem Button ‚Einfügen’ können Sie nun Positionen anlegen. Mit ‚OK’ speichern Sie Ihre Daten ab und über den ‚Schließen’-Button kehren Sie in das Fenster ‚Umlagerung’ zurück. Sie können jetzt weitere Positionen anlegen oder mit dem ‚Neu’-Button den Beleg abschließen. Die Umlagerung wird auf dem Lagerkonto verbucht und der aktuelle Bestand neu errechnet. Um möglichst schnell und effizient viele Lagerplätze umzulagern beachten Sie die Dokumentation zum Umlagerungsassistenten. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Positionsfenster: Um ein Teil auszuwählen öffnen Sie entweder mit dem Knopf 'Teil' die Teilestamm Selektionsmaske oder geben die Teilenummer im Eingabefeld neben dem Knopf ein. Die Daten aus dem Teilestamm und der aktuelle Lagerplatz werden mit in das Fenster übernommen. Im Feld ‚Umlagermenge’ tragen Sie bitte die Menge der umzulagernden Teile ein. Über den Button ‚zu Lagerplatz’ öffnet sich die Übersicht der Lagerplätze, in der Sie nun einen neuen Lagerplatz markieren und mit ‚OK’ auswählen können. Alternativ zur Übersicht kann im Eingabefeld neben dem Button ‚zu Lagerplatz’ direkt die Nummer eines Lagerplatzes eingegeben werden. Falls nur einer mit dieser Nummer existiert, wird er umgehend angezeigt. Wenn mehrere Lagerplätze mit der eingegebenen Nummer existieren werden die gefundenen Objekte im Selektionsfenster der Lagerplätze angezeigt. Wird kein Lagerplatz gefunden erscheint eine Meldung. Die Positionsnummer wird automatisch vorgegeben, kann aber geändert werden. Es werden alle Lagerplätze angezeigt, wo das Teil vorhanden ist/war und nur das "Ziellager" kann ein Lager sein, in dem das Teil noch nie vorhanden war. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Listenfenster: Dient der Auflistung der Umlagerungen. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Selektionsfenster: Dieses Fenster dient der Selektion einer Umlagerung. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Umlagerungsassistent: Mit dem Umlagerungsassistenten können Sie Massenumlagerungen durchführen: z.B. alle Teile auf einem Lagerplatz auf einen anderen umlagern oder ein Teil welches auf vielen Lagerplätzen lagert auf andere Lagerplätze verteilen. Dabei kann die Menge beliebig gewählt werden. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Umlagerungskriterien für Teil Lagerplatzkonten: Erfolgt eine Umlagerung direkt aus dem Kostenträger, Lagerplatz, einem Teil oder dem Lagerbestand werden alle in Frage kommenden Teil Lagerplatz Konten herausgefiltert. Nur jene mit Bestand (pos. oder neg.) und gültigen Teilen können umgelagert werden. Diese Konten werden in der "In Frage kommende Positionen" Liste dargestellt. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Empfangenden Lagerplatz auswählen: Der empfangende Lagerplatz wird bestimmt indem entweder das Lagerplatz Selektionsfenster geöffnet wird oder ein Lagerplatz per Direkteingabe gesucht wird. Es muss sich dabei um einen gültigen Lagerplatz handeln. Den empfangenden Lagerplatz können Sie jederzeit neu bestimmen und somit die Teil Lagerplatzkonten auf mehreren Lagerplätzen verteilen. Durch den Kostenträger erfolgt die Umbuchung zu einem Projektlager. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Empfangenden Lagerplatz zuweisen: Um selektierten Objekten aus der Liste "In Frage kommende Positionen" den ausgewählten Lagerplatz zuzuordnen werden diese mit dem Knopf in die "umzulagernde Positionen" eingefügt. Falls Sie einen anderen empfangenden Lagerplatz zuweisen möchten suchen Um Objekte aus der Liste "umzulagernde Positionen" zu entfernen drücken Sie den Knopf, bzw. die "Entf" Taste der Tastatur und die selektierten Objekte werden in die "In Frage kommenden Positionen" zurück verschoben. Um Objekte endgültig aus der Zusammenstellung zu entfernen selektierten Sie die gewünschten in der "In Frage kommenden Positionen" Liste und drücken die "Entf" Taste der Tastatur. Selektierte Objekte können auch per Drag&Drop von der einen in die andere Liste geschoben werden. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Umzulagernde Menge bestimmen: Die Menge kann per Doppelklick auf ein Objekt in der "umzulagernde Positionen" Liste beliebig geändert werden. Im Normalfall ist der komplette Bestand eines Teils auf dem jeweiligen Lagerplatz eingetragen. Falls durch eine Umlagerung ein negativer Bestand entstehen würde, erscheint ein Ja/Nein Abfrage Fenster für das betroffene Teil Lagerplatzkonto. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Optionsfenster: Hier können sämtliche Voreinstellungen für den Datenaustausch vorgenommen werden. Das Fenster kann nur über den "OK" Button geschlossen werden. Einmal eingestellte Optionen können für den angemeldeten Benutzer als Standardoption gespeichert werden. Hierfür ist auf der Lasche "Voreinstellungen" ein Kontextmenüeintrag auf der Liste "Benutzer Voreinstellungen", über den die aktuellen Optionen gespeichert werden können. Dies ist die Beschreibung der Funktionalität des Moduls "stockSwitching" mit dem Namen "Warenumlagerung" bezüglich Technische Erläuterungen Umlagerungsassistent: Aufruf des Assistenten erfolgt immer über die Message "STOCK_SWITCHING_WIZARD". "STOCK_SWITCHING_WIZARD" wird vom Modul stoswedt.mod empfangen und öffnet gegebenenfalls das EditWin und setzt "NULL -> stockSwitching" wenn noch keine Umlagerung existiert. Weiters empfängt auch das EditWin die Msg und führt das Makro "EditObject" aus und speichert die Umlagerung, falls noch keine existiert. Im "StockSwitchingWizardWin" wird falls etwas übergeben wurde "ObjectDropped" aufgerufen und anschließend wird ein Vektor aus transienten CX_CONTAINER Objekten erstellt. Die CX_CONTAINER erhalten die Datenfelder mit den Informationen die nötig sind, um daraus eine Umlagerungsposition erzeugen zu können. Damit die CX_CONTAINER nicht von der GarbageCollection weg geräumt werden, müssen diese in einem Vektor gesichert werden. Mögliche Übergabeparamenter für die Message: - NULL -> es wird nur das Fenster geöffnet - CX_ITEM Objekte oder Vektor bzw. Collection von CX_ITEM Objekten - CX_STOCK_SPACE Objekte oder Vektor bzw. Collection von CX_STOCK_SPACE Objekten - CX_LOG_CUBE Objekte oder Vektor bzw. Collection von CX_LOG_CUBE Objekten - diese Objekte werden immer darauf überprüft ob es Teile Lagerplatzkonten sind Das Makro "ObjectDropped" stellt eine CX_LOG_CUBE Collection zusammen aus den übergebenen Objekten indem es sich rekursiv aufruft. Dabei werden nur Teil Lagerplatzkonten übernommen die Bestand haben (pos. oder neg.) und dessen Teil gültig ist.