Dies ist die Beschreibung des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung": Allgemeine Übersicht des Workflows der Eingangsrechnungen Allgemeiner Ablauf der Eingansrechnungsbearbeitung Prüfgründe Kontierung Mehrsteuerrechnung Ermittlung der Rechnungsmenge Erfassung einer Pönale (Vertragsstrafe) Eingangsrechnungserfassung über gescannte Dokumente Allgemeine Hinweise Die Erfassung der Eingangsrechnungen der Kreditoren ist die Hauptaufgabe dieses Moduls und bildet die Grundlage der Gesamtaufgabe, dem Bearbeiten der Eingangsrechnungen. So ergeben sich weitere Teilaufgaben wie dem Prüfen der Rechnung, dem Vornehmen der Vorkontierung und dem Verbuchen in die FiBu. ClassiX® unterstützt diesen Prozess durch eine ergonomische, halbautomatische Erfassung der Eingangsrechnung. Über eine automatisierte Prüfung, welche die zu prüfenden Rechnungen den entsprechenden Mitarbeitern direkt zu Kontrolle vorlegt, wird die Zeitverzögerung durch Transport und Kommunikation zwischen den beteiligten Abteilungen/Mitarbeitern minimiert. Aufgrund der Zuordnung der Eingangsrechnung über die Beleghistorie zu den Bedarfsauslösern wird auch die Vorkontierung automatisch vorgenommen. die Verbuchung in die FiBu wird über das Rechnungseingangsbuch vorgenommen. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Allgemeiner Ablauf der Eingangsrechnungsbearbeitung: 1. Rechnungseingang / Optionen Das Erfassen einer Eingansrechnung beginnt außerhalb des ClassiX® Systems durch die Vergabe einer Paginiernummer. Den Stapel der zu erfassenden Rechnungen sollte man nun nach dieser Nummer sortieren. Hierdurch kann über die Optionen das "Eingangsdatum" und die "Auto. Paginiernummer" vorgeben, welche somit automatisch beim Erfassen jeder Rechnung gesetzt werden. Die Paginiernummer wird nach jeder Rechnung hochgezählt um dann beim Einpflegen der nächsten Rechnung wieder aktuell zu sein. Somit sollte der Rechnungsstapel nach dem LiFo-Prinzip (last in first out) sortiert sein, dass heißt die Rechnung mit der kleinsten Paginiernummer liegt immer oben. 2. Erstellen einer neuen Eingangsrechnung Das Anlegen einer neuen Eingangsrechnung in ClassiX beginnt mit dem Betätigen des Buttons NEU und dem Erfassen der Kopfdaten. Der Focus befindet sich nun im Feld Rechnungsnummer und springt durch RETURN weiter in das Feld Rechnungsdatum. diese beiden Felder sind als erstes zu füllen. 3. Anlegen der Eingangsrechnungspositionen Wieder über RETURN gelangt man nun in das Feld Bestellung. Durch Eintragen und Auslösen der Bestellnummer, auf welche sich die Eingangsrechnung bezieht, wird die Eingangsrechnung angelegt, die Paginiernummer und das Eingangsdatum gemäß der Optionen und der Kreditor gemäß der Bestellung übernommen. Wichtigster Bestendteil dieses Schrittes ist allerdings das Anlegen der Eingangsrechnungspositionen gemäß der Bestellung. Anschließend können auch weiter Bestellungen ausgelöst werden, falls der Lieferant mehrere Bestellungen zugleich in Rechnung gestellt hat. 4. Eingabe der Rechnungsbeträge Die Rechnungsbeträge werden der Effizienz halber in einem eigenem Fenster erfasst. Für den Rechnungskopf wären dies die Nebenkosten, der Steuer- und der Rechnungswert. Der Nettowert ergibt sich dann aus der Differenz. Zudem können Nebenkosten auch auf der Bestellebene erfasst werden. Dies ist vor allem dann Relevant, wenn mehrere Bestellung vom Lieferanten in einer Rechnung zusammengefasst wurden. Die Vorsteuer wird anhand des Lieferanten versucht automatisch zu ermitteln und als Vorauswahl angeboten. Überschreibt man die Steuer, so wird diese nicht nur in den Kopf, sondern auch auf alle neu angelegten Positionen übernommen. Zudem werden die Bestellkonditionen angezeigt und können hier ausgetauscht werden, wenn sich der Kreditor auf anderen Konditionen bezogen hat. Wenn über die Bestellung Fracht und Verpackung als Nebenkosten übernommen werden, erscheint ein Hinweis im Schnellabgleichfenster, damit diese Kosten nicht doppelt eingegeben werden. Die Bestellkopfkonditionen werden ebenfalls in die Eingangsrechnung mit übernommen. Nur wenn alle Konditionen der Bestellungen auch in der Eingangsrechnung auftauchen, kann die ER automatisch freigegeben werden. Die Nebenkosten tauchen in der Eingangsrechnung als Konditionen wieder auf, wobei die die Nebenkosten der Bestellpositionsebene wertmäßig auf die gerade automatisch angelegten Positionen verteilt werden. Beim Löschen von Positionen werd die Nebenkosten dann erneut verteilt. Als Folge dessen kann man die verteilten Konditionen nicht mehr über die Positionsmaske pflegen, sondern nur noch die original angelegten Positionsnebenkosten. Hierfür gibt es ein extra Fenster, welches man über das Menü Bearbeiten -> Konditionen -> Nebenkosten bearbeiten öffnet. Angezeigt werden zwei Spalten. Zum einen der Wert der Nebenkostenposition, welchen man über OboxEdit pflegen kann, zum anderen die Positionen, auf welche sich die Nebenkostenposition bezieht. In Klammern wird hinter jeder Position der verteilte Wert angegeben. 5. Erfassen "Freier Positionen" Eine freie Eingangsrechnungsposition dient der Erfassung derjenigen Eingangsrechnungen, welche nicht auf den regulären Weg erfasst werde können. Eine freie Eingangsrechnungsposition muss immer manuell erfasst werden. Zu den weiteren Besonderheit zählt unter anderem, dass sie nie direkt in den Status „Freigegeben“ läuft, sondern zuvor immer geprüft werden muss. Außerdem hat sie keinen Einfluss auf einen Bestellstatus, da die Positionen ohne Menge erfasst werden. Freie Positionen können nur erfasst werden, wenn die Rechnung bereits angelegt worden ist. Somit sollte man mindestens einmal gespeichert und den Kreditor, Paginiernummer, etc. bereits haben. Über den Button „Einfügen“ und dem sich öffnende Menü „Freie Position“ kann nun eine freie Position angelegt werden. Für den Fall, dass die Rechnung gar keiner ClassiX® Bestellung zugeordnet werden kann, müssen alle Daten der Position manuell gesetzt werden. Anderenfalls kann man zum Beispiel einen Bestellkopf als Vorgänger auswählen. In diesem Fall wird unter anderem der Kreditor auf den Rechnungskopf übernommen, wenn dies zu diesem Zeitpunkt noch nicht geschehen ist. Sollten die Daten für den Prüfer nicht ausreichen, so kann auch das Beschreibungsfeld genutzt werden. Das Feld „Rechnungsmenge“ bleibt bei dieser Art der Erfassung permanent geschlossen. Somit hat die Rechnungsposition keinen Einfluss auf den Rechnungsstatus der Bestellung. 6. Freigabezyklus Der nächste Schritt ist das Weiterschalten ("Freigeben") der Eingangsrechnung. Wird keine Position in der Positionsliste mit eine Stoppzeichen angezeigt, welches für eine manuelle Prüfung steht, so geht die Rechnung durch das Weiterschalten direkt in den Status "Freigegeben" und kann somit in die FiBu übernommen werden. Anderen falls werden alle Positionen, welche nicht automatisch freigegeben werden konnten den Prüfern zur Kontrolle vorgelegt. (siehe Prüfgründe) Zusätzlich kann im Mandanten eine Regel (Anerkennungsregel) hinterlegt werden, welche eine Rechnung automatisch akzeptiert. Die Regel könnte zum Beispiel lauten: "Der Nettowert der Rechnung liegt unter 100€." Wurde eine Rechnung erfasst, auf die die Regel zutrifft, so öffnet sich neben dem Button "Freigeben" ein Checkbox "Rechnung akzeptieren", welche voreingestellt angeklickt ist. Eine gesetzte Checkbox bedeutet, dass die Rechnung trotzdem kontrolliert wird, allerdings nicht in die manuelle Prüfung. Statt dessen wird die Rechnung direkt freigegeben. Die als Beispiel genannte Regel führt also dazu, dass alle Rechnungen unter 100€ direkt freigegeben und somit bezahlt werden können, obwohl Prüfgründe (z.B.: offener Wareneingang) vorliegen. Möchte man trotz der Regel eine Rechnung prüfen lassen, so muss der Hacken aus der Checkbox entfernt werden. Eingangsrechnungen die direkt anerkannt werden, müssen nicht genehmigt werden, auch wenn das Genehmigungsregelwerk dieses vorsieht. 6.1 Prüfen einer Position Liegen Gründe vor (siehe Prüfgründe), welche das automatische Freigeben einer Eingangsrechnungsposition untersagen, so wird diese Rechnung den Prüfern zu manuellen Freigabe vorgelegt. Zudem kann der Erfasser der Eingangsrechnung eine Position auch als "zu prüfen" markieren, obwohl keine definierten Prüfgründe zutreffen. Positionen im Status "Prüfen" werden in der Regel durch den Prüfer (Feld in der Positionenmaske) freigegeben. Dieser findet seine zu prüfenden Eingangsrechnungen in seinem Vorgangsordner. Für dem Prüfer sind alle Felder gesperrt, da er nur die Möglichkeit besitzen soll die Eingangsrechnung zu sperren oder freizugeben. Sperrt er eine Position, so wird auch die gesamte Eingangsrechnung gesperrt. Anderenfalls wird überprüft, ob nun alle Positionen Freigegeben wurden. Ist dies der Fall, so wird auch die Eingangsrechnung zum Verbuchen freigegeben. Für die Kontrolle der zu prüfenden Eingangsrechnungen wird dem Prüfer ein eigenes Werkzeug zu Verfügung gestellt. (siehe hier). Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Mehrsteuerrechnung: In der Regel wird der Steuerschlüssel sowohl im Eingangsrechnungskopf als auch in den Positionen hinterlegt, wobei in der ganzen Rechnung nur ein Steuerschlüssel verwendet werden darf. Bei Mehrsteuerrechnungen ist dies anders. Hier erhält der Eingangsrechnungskopf gar keine Zuweisung eines Steuerschlüssels, wodurch in den Positionen verschiedene Steuern erfasst werden können. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Kontierung: Topic zum Thema "Kontierung/Vorkontierung" Für die Kontierung einer Eingangsrechnung sind vier Werte notwendig, welche in den ER-Positionen gesetzt werden. Ein absolutes muss ist hierbei das FiBu-Konto und der Betrag. Das FiBu-Konto kann entweder ein Sachkonto/GuV-Konto oder eine Kostenart sein, wenn die Kostenartenkontierung durch die Einstellungen im Mandanten zugelassen wird. Die weiteren Werte sind die Kostenstelle und der Kostenträger. Das FiBu-Konto wird in der Regel direkt in der Bestellartikelrolle angegeben und wird beim Erfassen der Position automatisch gesetzt. Eine Ausnahme sind zum Beispiel Textartikel, hier wird eine "default"- Kostenart am Mandanten hinterlegt. Gleiches gilt auch für die Kontierung der Nebenkosten. Wichtige Hinweise: Die automatisch vorgenommen Kontierung kann im Rechnungseingangsbuch manuell geändert werden. Wurde dies getan, kann die Rechnung über die Bearbeitungsmaske nicht mehr geändert werden. Bei der Kostenträgerkontierung wird versucht der genau Anteil der Kostenträgerpositionen an einer Eingangsrechnung zu ermitteln. Hat ein oder mehrere Kostenträgervorgänger keine Mengen, da es der Auftragskopf oder eine Gruppe ist, so wird die Restmenge (BA Menge - Summe der Kostenträgermengen) anteilsmäßig auf die restlichen Positionen ohne Mengen aufgeteilt. Findet eine Überlieferung/Unterlieferung (BA Menge > oder < Summe der Kostenträgermengen und es gibt keine Positionen ohne Mengen) statt, so werden die Gesamtkosten anhand der Anzahl der Vorgänger aufgeteilt, da eine genau Zuordnung der Übermenge zu einer Kostenträgerposition nicht möglich ist. Ausschlaggebend für die Kostenaufteilung einer freien Position isst der Wert der Liefereinteilung(en). Hat eine freie Position eine oder mehrere Bestellungen als Vorgänger, so werden alle Liefereinteilungen dieser Bestellungen berücksichtigt. Bei der Freigabe bzw. dem Weiterschalten der Eingangsrechnungen wird die Kontierung auf das Vorhandensein eines Kostenträger bzw. einer Kostenstelle kontrolliert, wenn die Kostenart auf einen Kostenträger- bzw. Kostenstellenzwang besteht. Kontierung einer (EU) Erwerbssteuer Eine Erwerbssteuer von beispielsweise 16% wird in den Eingangsrechnungen wie 0% behandelt und hat nur Auswirkungen auf die Kontierung. Der angelegte Buchungscontainer für die Steuer hat nach außen hin (Anzeige im Rechnungseingangsbuch etc.) den Wert Null, intern in der Fibu wird jedoch mit dem 16%-Wert gerechnet. Manuelle Kontierung einer (EU) Erwerbssteuer. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Ermittlung der Rechnungsmenge: Die Rechnungsmenge wird versucht automatisch zu ermitteln, um auch hier bei der Erfassung Zeit zu sparen. Bei der Ermittlung dienen folgenden Mengen als Grundlage: - Bestellmenge - Liefermengen - QS - Mengen (bei QS-Teilen) - berechnete Menge (vom Lieferanten bereit in Rechnung gestellte Menge) Nach folgender Logik wird die Rechnungsmenge ermittelt wird. Kein QS-Teile: QS-Teile: Achtung! Es kann nur versucht werden die vom Lieferanten in Rechnung gestellte Menge zu ermitteln, eine 100%ige Sicherheit gibt es natürlich nicht. Daher sollet die Rechnungsmenge manuell kontrolliert werden, um Fehler zu vermeiden. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Erfassung einer Pönale (Vertragsstrafe): Das Pönale (engl. penalty) ist eine Vertragsstrafe oder auch Konventionalstrafe wegen Nicht- oder Schlechterfüllung von Lieferungen und Leistungen und wird als Geldstrafe ausgestaltet. Die Erfassung eines Pönals unterscheidet sich zu anderen Rechnungen im Einkauf dadurch, dass das Pönale als Ertrag und nicht als Aufwand zu werten ist. Somit muss bei der Kontierung ein Ertragskonto statt eine Aufwandskonto und ein Umsatzsteuerkonto statt einem Vorsteuerkonto angesprochen werden. Die Auswahl des Ertragskontos auf der Position unterscheidet sich nicht von normalen Eingangsrechnungen. Die Auswahl eines Umsatzsteuerschlüssels muss allerdings über die Optionen erst frei geschaltet werden. Das Pönale sollte als Gutschrift erfasst werden mit positiven Werten und einer Umsatzsteuer. Der Buchungssatz für eine Vertragsstrafe in Höhe von 100€ sieht dann wie folg aus: Für die Erfassung des Pönals empfiehlt sich eine freie Position, welche als Vorgänger dem Bestellkopf zugewiesen. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Eingangsrechnungserfassung über gescannte Dokumente: Bei der Eingangsrechnungserfassung über gescannte Dokumente wird davon ausgegangen, dass die Rechnungen bereits gescannt in einem Verzeichnis vorliegen. Die gescannten Eingangsrechnungen und Eingangsgutschriften müssen hierbei in getrennten Verzeichnissen abgelegt sein. Diese Verzeichnisse werden im Mandanten definiert. Zudem müssen zwei Verzeichnisse definiert werden, in welche die eingelesenen Dokumente verschoben und archiviert werden. Die Verzeichnisse sind nach folgendem Schema zu definieren: Pfad für gescannte Eingangsrechnungen : Z:\classix\Eingangsrechnungen\*.pdf Pfad für zu bearbeitende Eingangsrechnungen: Z:\classix\Eingangsrechnungen\InBearbeitung\ Pfad für archivierte Eingangsrechnungen: Z:\classix\Eingangsrechnungen\Archiv\ Wichtig ist, dass beim Pfad zu den gescannte Eingangsrechnungen auch der Typ des Dokumentes (pdf, tif, etc.) mit angegeben wird, da auch weitere Dateien, wie die Textdateien mit den aus den Dokumenten ausgelesenen Inhalten, hier abgelegt sein können. Damit der Ordner der archivierten Eingangsrechnungen nicht zu voll und dadurch unübersichtlich wird, gibt es die Option "Archivierte gescannte Dokumente in Unterordner (Jahr-Monat) verschieben". Durch diese Option werden unterhalb des Ordners weitere Unterordner mit der Bezeichnung "jjjj-mm" angelegt. Somit steht der Ordern "2013-01" für Januar 2013. Die Eingangsrechnungen werden in archiviert-Ordner verschoben, wenn Sie in die FiBu verbucht oder abgelehnt wurden. Bei Rechnungen, welche in die FiBu verbucht wurden, ist das Buchungsdatum des FiBu-Nachfolgers maßgeblich für das Anlegen und Verschieben in einen Unterordner. Bei abgewiesenen Eingangsrechnungen ist es das Rechnungsdatum. Der Dateiname muss der Paginiernummer der Rechnung/Gutschrift entsprechen. Der Dateiname kann zusätzlich mit "ER" oder "EG" beginnen, um über den Namen den Typ des Dokuments zu bestimmen. Allerdings werden die Dokumente über das unterschiedliche Verzeichnis unterschieden und nicht über dieses Kürzel. Beim Ermitteln der Paginiernummer wird das eventuell vorhandene Kürzel weggelassen. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Automatisches Anlegen der Eingangsrechnungen: Beim Öffnen der Bearbeitungsmaske wird kontrolliert, ob sich zu importierende, gescannte Dokumente im entsprechenden Verzeichnis befinden. Ist dies der Fall, wird dies in der Toolbar durch ein "GO"-Zeichen () kenntlich gemacht und die Anzahl der zu importierenden Dokumente angezeigt, im anderen Fall wird ein "STOP"-Zeichen () dargestellt. Der Import wird über das Betätigen des "Go"-Zeichen gestartet. Daraufhin wird im Verzeichnis der zu importierenden Rechnungen nach der Datei mit der kleinsten Paginiernummer gesucht. Konnte keine Paginiernummer mit einem gültigen Format gefunden werden oder wurde die Paginiernummer bereits verwendet, so wird der Vorgang abgebrochen. Im nächsten Schritt wird die Datei in das Archivverzeichnis verschoben. Befindet sich eine gleichnamige Datei mit der Endung ".txt" in dem Verzeichnis, so wird auch diese in das Archivverzeichnis verschoben. Als nächstes wird nun eine neue Rechnung mit der ermittelten Paginiernummer angelegt und die in das Archivverzeichnis verschobene Datei mit ihr assoziiert. Dies geschieht mittels lokaler Dokumentreferenzen. Das Dokument wird zudem automatisch geöffnet, so dass die Rechnungsdaten ermittelt und in die Eingangsrechnungsmaske übertragen werden können. Das mit der Rechnung assoziierte Dokument kann jederzeit über den Toolbar Button zur Bearbeitung der Assoziationen () geöffnet werden. Wurde der gescannte Inhalt des Eingangsrechnungsdokumentes in eine gleichnamige Textdatei gestellt, so wird diese nach Daten durchsucht, welche automatisch in die Rechnungsmaske übernommen werden können. Dies ist zum Beispiel der Lieferant, welche über die Umsatzsteuer-ID ermittelt werden kann. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Manuelles Anlegen der Eingangsrechnungen: Es ist auch möglich die Eingangsrechnung manuell zu erfassen, zum Beispiel wenn das Eingangsrechnungsdokument analog vorliegt. In diesem Fall wird die Eingangsrechnung mit der Paginiernummer in ClassiX erfasst. Anschließend wird von ClassiX automatisch geprüft, ob im Ordner für die gescannten Eingangsrechnungen ein gleichnamiges Dokument vorliegt. Ist dies der Fall, so wird die lokaler Dokumentreferenzen angelegt und mit der Eingangsrechnung verknüpft. Das Dokument wird in den "in Bearbeitungs"-Ordner verschoben. Das PDF öffnet sich hierbei nicht automatisch, da in diesem Fall die Erfassung nicht über das PDF erfolgt. Im Fall des manuellen Anlegen der Eingangsrechnung/-Gutschrift ist es nicht nötig die gescannten Dokumente in verschiedene Ordner für Rechnungen und Gutschriften abzulegen, da die Unterscheidung ob Rechnung oder Gutschrift manuell über die Erfassung erfolgt. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Allgemeine Hinweise: Nur nachdem jede einzelne der Eingangsrechnungspositionen freigegeben wurde kann die gesamte Eingangsrechnung gebucht werden. Der Zugriff auf die Eingangsrechnungsmodule wird verboten, wenn die Bestellungen und die Kontierungsmonitore unterschiedlichen Mandanten (Domänen) gehören. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Listenfenster: Dient der Auflistung der Eingangsrechnungen. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Selektionsfenster: Dieses Fenster dient der Selektion einer Eingangsrechnung. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Implementation: checkMask CalculatePurchaseInvoice Steuert die gesamte Kalkulation der Eingangsrechnung CalculateSubPositions MarkAllBookingContainers DetailedAccounting CleanAllBookingContainers CalculateSubPositions Addiert alle Netto- und Bruttowerte (Pos. Summen) der Eingangsrechnungspositionen. Diese Werte dienen der Berechnungsgrundlage (Pos. Summen + Konditionen(CalculateSingleCharge)) des errechneten Eingangsrechnungswert. CalculateGrosDifference MarkAllBookingContainers Initialisiert die Werte der Buchungscontainer. DetailedAccounting CalculateFirstDifferences AccountingRecursive CalculateFirstDifferences_Tax AccountingRecursive_Tax CalculateFirstDifferences Berechnet und verteilt die Kosten der Eingangsrechnung/Position. Das Ergebnis ist der Vektor accounted.amount, der sich wie folgt aufteilt: CX_PURCHASE_INVOICE 0 -> Basiswert der Position (Summe der Pos.Nettopreise + Rabatte/Zuschläge + Differenz) 1 -> Aufschläge (Fracht/Verpackung) CX_LINK_TXN 0 -> Basiswert der Position (Menge * Preis + Rabatte/Zuschläge + Differenz) (Nettodifferenz: der Position + prozentual der Eingangsrechnung) 1 -> Aufschläge (Fracht/Verpackung) 2 -> prozentualer Mehrwert durch den Aufschläge im Eingangsrechnungskopf GetBaseAccountingValue InitAccountedAmount AccountingRecursive Wird eine Eingangsrechnung an das Makro übergeben, so werden alle Positionen durch den Aufruf des Makros CalculateFirstDifferences durchkalkuliert. Anschließend werden Aufschläge und die Nettodifferenz auf die Postionen verteilt, bevor sich das Makro rekursiv aufruft. Für die Positionen werden dann über den Aufruf des Makro AccountTmpPos die Buchungskontainer erstellt. AccountTmpPos CalculateFirstDifferences GetBaseAccountingValue Ermittelt den Nettowert der Eingangsrechnung (Summe der Positionen)/Position (Menge * Preis). InitAccountedAmount Initialisiert die Vektoren welche sich hinter accounted.amount (siehe CalculateFirstDifferences) verbergen. Dem erste Vektor wird der Rückgabewert des Makros GetBaseAccountingValue zugewiesen, alle weiteren der Wert "0". CalculateFirstDifferences_Tax Wird dem Makro eine Eingangsrechnungsposition übergeben, so wird diese der Steuerwerte (Brutto-Netto) berechnet. Mit diesem Wert wird dann das 0te Element des taxed.amount Vektors initialisiert. Das 1te Element erhält den Wert "0". Wird anderenfalls ein Eingangsrechnungsobjekt übergeben, so wird der Steuerwerte auf Grundlage der Summen der Netto- und Bruttowerte berechnet. Der Vektor wird dann gleichermaßen vorinitialisiert. Die Differenz zwischen dem errechneten und dem tatsächlichem Steuerwert, wird dann in das zweite Element geschrieben. AccountingRecursive_Tax CalculateFirstDifferences_Tax CalculateSingleCharge Berechnet den Nettowert inkl. der Konditionen. calcCondition -> die aktuelle Kondition, welche es zu berechnen gilt initialSum -> der Wert exkl. der Konditionen (wird für die Berechnung "von Warenwert verwendet") sum -> der Wert inkl. der bis dahin berechneten Konditionen singleDiscount -> der Wert der gerade zu berechnenden Kondition. Dies ist die Beschreibung der Funktionalität des Moduls "purchaseInvoiceHeader" mit dem Namen "Eingangsrechnung" bezüglich Qualitätssicherung: Meldungen bei der Kontierung.