Dies ist die Beschreibung des Moduls "cxCurrencyTable" mit dem Namen "Währungstabelle": Die Konvertierung von Währungen stellt im Gegensatz zur Konvertierung von anderen Einheiten insofern einen Sonderfall dar, da das Verhältnis (d.h. der Wechselkurs) zwischen zwei Währungen nicht fest ist, sondern sich täglich ändert. Die Konvertierung muss mit Hilfe einer Währungstabelle, die Wechselkurse zwischen verschiedenen Währungen definiert, umgerechnet werden. Diese Währungstabelle kann im System - für einzelne Tage oder Zeiträume zwar unterschiedlich - aber doch mehrfach vorhanden sein.Um diese - Zeit abhängigen - Währungstabellen unterscheiden zu können, empfiehlt es sich, den Währungstabellen eindeutige Namen zu geben (z.B. EUROFX für die täglich aktualisierbare Währungstabelle der EZB (Europäische Zentralbank)). Alle Währungstabellen eines bestimmten Namens werden über ihre Gültigkeit auseinander gehalten, d.h. es sollte immer nur jeweils eine Währungstabelle eines bestimmten Namens zu einer gegebenen Zeit im System gültig sein. Um jeweils aktuelle Umrechnungskurse zu haben, kann man sich die Kurse automatisch über das Internet aktualisieren lassen.Im Regelfall konvertiert das System einen Wert in einer Fremdwährung in den Wert der eigenen Hauswährung anhand der aktuell angemeldeten Währungstabelle. In einigen Fällen kann dieses unerwünscht sein, so z.B. bei Ausgangsrechnungen, Eingangsrechnungen und bei Übernahme von Bankauszügen. In diesen Fällen soll eventuell nicht die aktuell angemeldete Währungstabelle, sondern die nur an einem bestimmten Tag gültige Währungstabelle herangezogen werden. Die hierfür notwendigen Einstellungen werden im Mandanten (siehe für Ausgangsrechnungen, Eingangsrechnungen und Bankauszügen) vorgenommen.Neben den Währungstabellen, welche nach dem Anmelden für das ganze System gültig sind, gibt es auch Tabellen, welche ausschließlich einer Firma (einem Kunden) zugeordnet werden können. (siehe Kundendokumentation und Fremdwährung). Dies ist die Beschreibung der Funktionalität des Moduls "cxCurrencyTable" mit dem Namen "Währungstabelle" bezüglich Direktes Konvertieren: Beim direkten Konvertieren wird genau ein Wechselkurs benutzt, um eine Währung in eine andere zu konvertieren. Dabei wird die Liste der Wechselkurse der Reihe nach durchlaufen und der erste Wechselkurs, mit dem ein Umrechnen möglich ist, benutzt. Wenn eine Konvertierung mit mehreren Wechselkursen, d.h. "über andere Währungen hinweg", möglich sein soll, ist das Indirekte Konvertieren zu benutzen. Dies ist die Beschreibung der Funktionalität des Moduls "cxCurrencyTable" mit dem Namen "Währungstabelle" bezüglich Indirektes Konvertieren: Beim indirekten Konvertieren kann, im Gegensatz zum direkten Konvertieren, "über mehrere Währungen hinweg" konvertiert werden. Soll beispielsweise ein "€"-Betrag in "$" umgerechnet werden, so muss nicht unbedingt ein Wechselkurs zwischen diesen beiden Währungen definiert sein. Falls jeweils ein Wechselkurs zwischen "€" und "£" und zwischen "£" und "$" vorhanden ist, so kann ein "€"-Betrag mit dem "Umweg" über "£" in "$" konvertiert werden. Die Länge des Konvertierungsweges spielt dabei keine Rolle. Dies ist die Beschreibung der Funktionalität des Moduls "cxCurrencyTable" mit dem Namen "Währungstabelle" bezüglich Aktualisieren: Da Wechselkurse Schwankungen unterliegen, ist es notwendig, die Währungstabellen zu aktualisieren. Hierzu bringt ClassiX® eine Funktion zur automatischen Aktualisierung via Internet mit. Basis für die Aktualisierung stellen die Referenzkurse anderer Währungen zum Euro dar, die werktäglich aktuell von der Europäischen Zentralbank herausgegeben werden. Die Kurse sind online verfügbar unter http://www.ecb.int/stats/exchange/eurofxref/html/index.en.html. Parallel dazu stellt die EZB die Kurse auch in einer XML-Datei bereit, welche zur automatischen Verarbeitung besser geeignet ist. Diese XML-Datei wird auch vom ClassiX®-System genutzt, um die Währungstabellen zu aktualisieren. Die Aktualisierung kann entweder online geschehen, d.h. ClassiX® versucht selbstständig die XML-Datei zu laden und aktualisiert dann die Währungstabellen, oder aber offline, falls kein Internetzugang verfügbar ist. In diesem Falle muss die XML-Datei auf anderem Wege auf den Rechner kopiert werden und kann dann ausgelesen werden. Dies ist die Beschreibung der Funktionalität des Moduls "cxCurrencyTable" mit dem Namen "Währungstabelle" bezüglich Eingabefenster: Dieses Fenster dient der Pflege von Währungstabellen. Sie können eine Währungstabelle auswählen, in dem Sie im Feld "ID" die ID des gewünschten Objekts eingeben (z.B. EUROFX) und mit RETURN bestätigen. Wenn Sie das Listenfenster aufrufen wollen, dann können Sie den Menüpunkt "Suchen" auswählen. Das Eingabefenster enthält auch eine Funktion zur automatischen Aktualisierung von Währungstabellen eines bestimmten Namens. Diese Funktion ist über den Menüpunkt "Aktualisieren" zu erreichen. In dem Untermenü befinden sich Menüpunkte für verschiedene Quellen mit aktuellen Kursdaten (derzeit nur "EZB" (Europäische Zentralbank)). Jeder Menüpunkt enthält die Unterpunkte "Online" und "Offline" (oder auch nur einen von diesen), welche das Aktualisieren direkt über das Internet oder über eine lokal gespeicherte Datei ermöglichen (im von der EZB vorgegebenem XML Format). Im Nachfolgenden werden die beiden Arten der Aktualisierung ("Online" und "Offline") genauer erklärt. Online-Aktualisierung Bei der Online-Aktualisierung werden die neuen Kursdaten direkt aus dem Internet geladen. Dazu muss eine URL angegeben werden, die die Quelle genau spezifiziert (siehe auch oben). Als (zu aktualisierende) Tabelle wird die im System angemeldete gültige Währungstabelle angeboten: nur die in dieser Tabelle angegeben Währungen werden in eine neue Währungstabelle mit den aktuellen Werten übernommen. Will man alle die von der EZB angebotenen Währungen laden oder hatte man bisher noch keine Währungstabelle im System definiert, bleibt das Feld "Tabelle" leer und man erhält eine neue Währungstabelle mit allen von der EZB definierten Kursen. (Diese könnte man im Anschluss um die nicht benötigten Kurse bereinigen, um für die nächste Aktualisierung eine geeignete Ausgangstabelle zu haben). Generell darf immer nur eine Währungstabelle gültig sein. Diese wird dann auch beim Start von ClassiX® automatisch ausgewählt und angemeldet. Daher muss das Startdatum der Gültigkeit angegeben werden. Standardmäßig wird hier das Datum der Kursdaten gewählt. Über den Radiobutton lässt sich aber auch ein eigenes Datum auswählen. Die bis hierhin aktuell gültige Währungstabelle wird automatisch als ungültig markiert. Sie läuft mit dem Vortag des Starts der Gültigkeit der aktuellen Tabelle aus. Offline-Aktualisierung Die Offline-Aktualisierung funktioniert analog zur Online-Aktualisierung, mit dem einzigen Unterschied, dass statt einer URL zur Datenquelle im Internet diesmal ein Pfad zu einer Datei mit den neuen Kursdaten als Grundlage dient. Als Vorauswahl wird hier in diesem Falle (Datenquelle "EZB") die Datei "euroxref-daily.xml" im Verzeichnis Projects\Data unterhalb von CX_ROOTDIR angeboten. Mit Klick auf den "Wählen" Knopf lässt sich auf einfache Art und Weise aber auch eine andere Datei in einem anderen Verzeichnis wählen. Mit dem Button "Start" wird der Ladevorgang gestartet, mit "Schließen" wird der Dialog beendet. Dies ist die Beschreibung der Funktionalität des Moduls "cxCurrencyTable" mit dem Namen "Währungstabelle" bezüglich Listenfenster: Dient der Auflistung der Währungstabellen. Dies ist die Beschreibung der Funktionalität des Moduls "cxCurrencyTable" mit dem Namen "Währungstabelle" bezüglich Selektionsfenster: Dieses Fenster dient der Selektion einer Währungstabelle. Dies ist die Beschreibung der Funktionalität des Moduls "cxCurrencyTable" mit dem Namen "Währungstabelle" bezüglich Übersicht: Zur Verwaltung von Wechselkursen stellt ClassiX® die Klassen CX_CURRENCY_RATE und CX_CURRENCY_TABLE zur Verfügung. Mit einem Objekt der erstgenannten wird ein einzelner Wechselkurs definiert, während ein Objekt der zweiten Klasse eine Tabelle von Wechselkursen beinhaltet. Dabei kann diese Tabelle nicht nur Wechselkurse, sondern auch weitere (untergeordnete) Wechselkurs-Tabellen enthalten. Funktionalität zur Währungs-Konvertierung existiert in beiden Klassen, jedoch wird üblicherweise eine Tabelle zur Konvertierung benutzt.